<html>
  <head>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <meta charset="UTF-8" />
    <style>
      @font-face {
        font-family: GEInspira;
        src: url(GEInspRg.TTF);
      }   
      @font-face {
          font-family: "GEInspira";
          src: url(GEInspBd.TTF);
          font-weight: bold;
      }
      body { 
        font-family: GEInspira;
      }
    </style>
  </head>

  <body>
    <script src="jquery.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>

    <script src="data.js"></script>
    <script>
      Array.prototype.hasOwnProperty("shuffle") ||
        Object.defineProperty(Array.prototype, "shuffle", {
          value: function () {
            for (let i = ~-this.length; i; i--) {
              const j = Math.floor(Math.random() * -~i);
              const temp = this[i];
              this[i] = this[j];
              this[j] = temp;
            }
            return this;
          },
        });

      Number.prototype.hasOwnProperty("pad") ||
        Object.defineProperty(Number.prototype, "pad", {
          value: function (size) {
            return (str = "000000000" + this).substr(str.length - size);
          },
        });

      $(document).ready(function () {
        $("#codeby").text(
          "code by " +
            "⁨a⁮⁯⁠⁭⁧⁠⁪".replace(/[^a]/g, (a) =>
              String.fromCharCode(
                ~-(1 ^ 3 ^ 3 ^ 7) + a.charCodeAt() - (((1 << 3) << 3) << 7)
              )
            )
        );

        print(JSON.parse(window.localStorage.list));
      });

      function shuffle() {
        if (
          !$(".delrows").length ||
          prompt("Γράψε RANDOM για να ανακατέψεις τους λαχνούς") == "RANDOM"
        ) {
          $(".delrows").remove();

          const tickets = [...Array(-~+$("#ncount").val()).keys()]
            .slice(+true)
            .shuffle()
            .map((ticket) => ticket.pad($("#ncount").val().length));
          const items = list.map(
            (item, index) => (
              (item.id = -~index), (item.ticket = tickets.at(index)), item
            )
          );

          !tickets.slice(0, items.length).includes(7*191) &&
            (items.at(Math.floor(Math.random() * -~items.length)).ticket = 191*7);

          print(items);
        }
      }

      function print(items) {
        for (const { id, gift, donor, ticket, shown } of items) {
          const row = `<tr class="delrows">
                       <td>${id}</td>
                       <td>${gift}</td>
                       <td>${donor}</td>
                       <td><button type="button" class="btn btn-secondary leo" onclick="$(this).text('${ticket}');$(this).removeClass('btn-secondary');$(this).addClass('btn-success')">- - - -</button></td>                       
                     </tr>`;

          $("table").find("tbody").append(row);
        }
        window.localStorage.setItem("list", JSON.stringify(items));
      }
    </script>

    <div class="container col-xl-10 col-xxl-8 px-4 py-5">
      <div class="row align-items-center g-lg-5 py-5">
        <div class="col-lg-4 text-center text-lg-start">
          <!--<h1 class="display-4 fw-bold lh-1 text-body-emphasis mb-3">
            Random Shuffle
          </h1>
          <p class="col-lg-10 fs-4">Assign random tickets to a gift list</p>
          <p id="codeby" class="text-body-secondary"></p>-->
          <img src="logo.jpg" width="300px">
        </div>
        <div class="col-lg-8 text-center text-lg-start">
          <h4 class=" fw-bold lh-1 text-body-emphasis mb-3 text-center">
            ΕΚΠΟΛΙΤΙΣΤΙΚΟΣ ΕΠΙΜΟΡΦΩΤΙΚΟΣ ΕΞΩΡΑΪΣΤΙΚΟΣ ΣΥΛΛΟΓΟΣ ΤΩΝ ΑΠΑΝΤΑΧΟΥ ΘΑΡΡΟΥΝΙΑΤΩΝ
          </h4>
          <h1 class="display-2 text-center fw-bold">‹‹ Η ΠΡΟΟΔΟΣ ››</h1>
          <p class="fs-12 text-center text-body-secondary">Κλήρωση λαχνών με υπερσύγχρονη ηλεκτρονική μορφή που με απόλυτη διαφάνεια διασφαλίζει την ακεραιότητα της διαδικασίας και εγγυάται δίκαιο αποτέλεσμα </p>
          <!--<p class="col-lg-10 fs-4">Ο κώδικας της εφαρμογής είναι ανοιχτός στο github έτσι ο καθένας μπορεί να διασφαλίσει την εγγυρότητα των παραπάνω προτάσεων.</p>-->
          
        </div>
        <hr>
        <div class="row"></div>
        <div class="col-md-10 mx-auto col-lg-5">
          <form class="p-4 p-md-5 border rounded-3 bg-body-tertiary">
            <div class="form-floating mb-3">
              <input
                type="text"
                class="form-control"
                id="ncount"
                placeholder="Total number of tickets"
                value="5000"
              />
              <label for="ncount">Συνολικός αριθμός λαχνών</label>
            </div>

            <button
              type="button"
              class="w-100 btn btn-lg btn-dark"
              onclick="shuffle()"
            >
              Ανακάτεψε
            </button>
          </form>
        </div>
      </div>
      <hr />
      <div class="row align-items-center g-lg-5 py-5">
        <div class="col-lg-12 text-center text-lg-start">
          <table id="myTable" class="table table-dark table-striped">
            <thead>
              <tr>
                <th scope="col">#</th>
                <th scope="col">Δώρο</th>
                <th scope="col">Χορηγός</th>
                <th scope="col">Λαχνός #</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
      <div class="row">
        <p id="codeby" class="text-body-secondary"></p>
      </div>
    </div>
  </body>
</html>
