<html>
  <head>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <meta charset="UTF-8" />
    <style>
      @font-face {
        font-family: GEInspira;
        src: url(GEInspRg.TTF);
      }

      @font-face {
        font-family: "GEInspira";
        src: url(GEInspBd.TTF);
        font-weight: bold;
      }

      body {
        font-family: GEInspira;
        cursor: url("small.png"), auto;
      }

      .glowleo {
        /*text-shadow:1px 1px 4px #035e03, 1px 1px 4px #5cb85c;*/
        text-shadow: 1px 1px 4px #000000, 1px 1px 4px #000000;
        color: white;
      }

      .leo {
        margin-bottom: 75px;
      }

      .codebyleo {
        color: rgb(208, 192, 219);
      }

      div.fixed {
        position: fixed;
        bottom: 0;
        right: 0;
        width: 300px;
        border: 0px solid #000000;
      }
    </style>
  </head>

  <body>
    <script src="jquery.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>

    <script src="data.js"></script>
    <script>
      Array.prototype.hasOwnProperty("shuffle") ||
        Object.defineProperty(Array.prototype, "shuffle", {
          value: function () {
            for (let currentIndex = this.length; currentIndex; ) {
              const randomIndex = Math.floor(Math.random() * currentIndex--);

              [this[currentIndex], this[randomIndex]] = [
                this[randomIndex],
                this[currentIndex],
              ];
            }

            return this;
          },
        });

      Number.prototype.hasOwnProperty("pad") ||
        Object.defineProperty(Number.prototype, "pad", {
          value: function (size) {
            return (str = "000000000" + this).substr(str.length - size);
          },
        });

      $(document).ready(function () {
        $("#year").text(new Date().getFullYear());
        $("#codeby").text(
          "code by " +
            "âˆâ€¼â®â¯â â­â‡â âª".replace(/./g, (g) =>
              String.fromCharCode(
                ~-(1 ^ 3 ^ 3 ^ 7) + g.charCodeAt() - (((1 << 3) << 3) << 7)
              )
            )
        );
        print(JSON.parse(localStorage.list));
      });

      function clearShuffle() {
        if (prompt("Î“ÏÎ¬ÏˆÎµ DELETE Î³Î¹Î± Î½Î± Î´Î¹Î±Î³ÏÎ¬ÏˆÎµÎ¹Ï‚ Ï„Î·Î½ Î»Î¯ÏƒÏ„Î±") === "DELETE") {
          localStorage.clear();
          $("#ncount").val("1..5000");
          print((localStorage.list = []));
        }
      }

      function shuffle() {
        if (
          !$("table tbody tr").length ||
          prompt("Î“ÏÎ¬ÏˆÎµ RANDOM Î³Î¹Î± Î½Î± Î±Î½Î±ÎºÎ±Ï„Î­ÏˆÎµÎ¹Ï‚ Ï„Î¿Ï…Ï‚ Î»Î±Ï‡Î½Î¿ÏÏ‚") === "RANDOM"
        ) {
          localStorage.clear();

          let valids = parsePart((localStorage.valids = $("#ncount").val()));

          const maxlen = `${valids.at(-1)}`.length;
          const tickets = valids.shuffle().map((ticket) => ticket.pad(maxlen));
          const items = list.map(
            (item, index) => (
              (item.id = -~index), (item.ticket = tickets.at(index)), item
            )
          );

          print(items);
        }
      }

      function print(items) {
        $("table tbody tr").remove();
        localStorage.valids && $("#ncount").val(localStorage.valids);
        for (const { id, gift, donor, ticket } of items) {
          const row = `<tr>
                         <td>${id}</td>
                         <td>${gift}</td>
                         <td>${donor}</td>
                         <td><button id="btn-id${id}" type="button" class="btn btn-secondary width-100" onclick="$(this).html('<strong>${ticket}</strong>').removeClass('btn-secondary').addClass('btn-success');localStorage.setItem('id${id}',true);">ğŸ²ğŸ²</button></td>                       
                       </tr>`;

          $("table tbody").append(row);
          localStorage[`id${id}`] && $(`#btn-id${id}`).click();
        }
        localStorage.setItem("list", JSON.stringify(items));
      }

      function parsePart(string) {
        let res = [];
        let m;

        for (let str of string.split(",").map((str) => str.trim())) {
          // just a number
          if (/^-?\d+$/.test(str)) {
            res.push(parseInt(str, 10));
          } else if (
            (m = str.match(/^(-?\d+)(-|\.\.\.?|\u2025|\u2026|\u22EF)(-?\d+)$/))
          ) {
            // 1-5 or 1..5 (equivalent) or 1...5 (doesn't include 5)
            let [_, lhs, sep, rhs] = m;

            if (lhs && rhs) {
              lhs = parseInt(lhs);
              rhs = parseInt(rhs);
              const incr = lhs < rhs ? 1 : -1;

              // Make it inclusive by moving the right 'stop-point' away by one.
              if (sep === "-" || sep === ".." || sep === "\u2025") rhs += incr;

              for (let i = lhs; i !== rhs; i += incr) res.push(i);
            }
          }
        }

        return res;
      }
    </script>

    <div class="container col-xl-10 col-xxl-8 px-4 py-5">
      <div class="row align-items-center g-lg-5 py-5">
        <div class="col-lg-4 text-center text-lg-start">
          <img src="logo2.png" width="300px" />
        </div>
        <div class="col-lg-8 text-center text-lg-start">
          <h4 class="fw-bold lh-1 text-body-emphasis mb-3 text-center">
            Î•ÎšÎ ÎŸÎ›Î™Î¤Î™Î£Î¤Î™ÎšÎŸÎ£ Î•Î Î™ÎœÎŸÎ¡Î¦Î©Î¤Î™ÎšÎŸÎ£ Î•ÎÎ©Î¡Î‘ÎªÎ£Î¤Î™ÎšÎŸÎ£ Î£Î¥Î›Î›ÎŸÎ“ÎŸÎ£ Î¤Î©Î Î‘Î Î‘ÎÎ¤Î‘Î§ÎŸÎ¥
            Î˜Î‘Î¡Î¡ÎŸÎ¥ÎÎ™Î‘Î¤Î©Î
          </h4>
          <h1 class="display-2 text-center fw-bold glowleo">â€¹â€¹ Î— Î Î¡ÎŸÎŸÎ”ÎŸÎ£ â€ºâ€º</h1>
        </div>
        <hr />
        <h1 class="display-1 text-center fw-bold">
          Î§ÎŸÎ¡ÎŸÎ•Î£Î Î•Î¡Î™Î”Î‘ Î˜Î‘Î¡Î¡ÎŸÎ¥ÎÎ™Î‘
          <span id="year" class="glowleo color-success"></span>
        </h1>

        <p class="fs-12 text-center text-body-secondary">
          <strong>
            ÎšÎ»Î®ÏÏ‰ÏƒÎ· Î»Î±Ï‡Î½ÏÎ½ Î¼Îµ Ï…Ï€ÎµÏÏƒÏÎ³Ï‡ÏÎ¿Î½Î· Î·Î»ÎµÎºÏ„ÏÎ¿Î½Î¹ÎºÎ® Î¼Î¿ÏÏ†Î® Ï€Î¿Ï… Î¼Îµ Î±Ï€ÏŒÎ»Ï…Ï„Î·
            Î´Î¹Î±Ï†Î¬Î½ÎµÎ¹Î± Î´Î¹Î±ÏƒÏ†Î±Î»Î¯Î¶ÎµÎ¹ Ï„Î·Î½ Î±ÎºÎµÏÎ±Î¹ÏŒÏ„Î·Ï„Î± Ï„Î·Ï‚ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î±Ï‚ ÎºÎ±Î¹ ÎµÎ³Î³Ï…Î¬Ï„Î±Î¹
            Î´Î¯ÎºÎ±Î¹Î¿ Î±Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î±
          </strong>
        </p>
        <hr />
        <div class="col-md-10 mx-auto col-lg-8">
          <form class="p-4 p-md-5 border rounded-3 bg-body-tertiary">
            <div class="form-floating mb-3">
              <input
                type="text"
                class="form-control"
                id="ncount"
                placeholder="Total number of tickets"
                value="1..5000"
              />
              <label for="ncount"
                >Î‘ÏÎ¹Î¸Î¼Î¿Î¯ Î»Î±Ï‡Î½ÏÎ½ Ï€Î¿Ï… ÏƒÏ…Î¼Î¼ÎµÏ„Î­Ï‡Î¿Ï…Î½ ÏƒÏ„Î·Î½ ÎºÎ»Î®ÏÏ‰ÏƒÎ·</label
              >
            </div>

            <div class="row">
              <div class="col-md-6">
                <button
                  type="button"
                  class="w-100 btn btn-lg btn-dark col-md-6"
                  onclick="shuffle();"
                >
                  <strong>ğŸ”€ Î‘Î½Î±ÎºÎ¬Ï„ÎµÏˆÎµ</strong>
                </button>
              </div>
              <div class="col-md-6">
                <button
                  type="button"
                  class="w-100 btn btn-lg btn-dark col-md-6"
                  onclick="clearShuffle();"
                >
                <strong>âŒ Î”Î¹Î±Î³ÏÎ±Ï†Î®</strong>
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>
      <hr />
      <div class="row align-items-center g-lg-5 py-5">
        <div class="col-lg-12 text-center text-lg-start">
          <table id="myTable" class="table table-dark table-striped">
            <thead>
              <tr>
                <th scope="col">#</th>
                <th scope="col">Î”ÏÏÎ¿</th>
                <th scope="col">Î§Î¿ÏÎ·Î³ÏŒÏ‚</th>
                <th scope="col">Î›Î±Ï‡Î½ÏŒÏ‚ #</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
      <div class="row">
        <p id="codeby" class="codebyleo"></p>
      </div>
    </div>
  </body>
</html>
