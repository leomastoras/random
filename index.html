<html>
  <head>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <meta charset="UTF-8" />
    <style>
      @font-face {
        font-family: GEInspira;
        src: url(GEInspRg.TTF);
      }

      @font-face {
        font-family: "GEInspira";
        src: url(GEInspBd.TTF);
        font-weight: bold;
      }

      body {
        font-family: GEInspira;
        cursor: url("small.png"), auto;
      }

      .glow {
        text-shadow: 1px 1px 4px #000000, 1px 1px 4px #000000;
        color: white;
      }
    </style>
  </head>

  <body>
    <script src="jquery.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>

    <script src="data.js"></script>
    <script>
      Math.cryptoRandom = function () {
        const randomBuffer = new Uint32Array(+true);
        (crypto || msCrypto).getRandomValues(randomBuffer);
        return randomBuffer.at() / 2 ** 32;
      };

      Array.prototype.hasOwnProperty("shuffle") ||
        Object.defineProperty(Array.prototype, "shuffle", {
          value: function () {
            for (let currentIndex = this.length; currentIndex; ) {
              const randomIndex = Math.floor(
                Math.cryptoRandom() * currentIndex--
              );

              [this[currentIndex], this[randomIndex]] = [
                this[randomIndex],
                this[currentIndex],
              ];
            }

            return this;
          },
        });

      Number.prototype.hasOwnProperty("pad") ||
        Object.defineProperty(Number.prototype, "pad", {
          value: function (size) {
            return (str = "000000000" + this).substr(str.length - size);
          },
        });

      $(document).ready(function () {
        let date = new Date(new Date().getFullYear() + "-7-1");
        while (date.getDay() != 6) {
          date.setDate(date.getDate() + 1);
        }
        date.setDate(date.getDate() + 7);
        $("#date").text(
          `Î£Î¬Î²Î²Î±Ï„Î¿, ${date.getDate()} Î™Î¿Ï…Î»Î¯Î¿Ï… ${date.getFullYear()}`
        );

        $("#sign").text(
          `code by ${"âˆâ€¼â®â¯â â­â‡â âª".replace(/./g, (g) =>
            String.fromCharCode(
              ~-(1 ^ 3 ^ 3 ^ 7) + g.charCodeAt() - (((1 << 3) << 3) << 7)
            )
          )}`
        );
        print(JSON.parse(localStorage.list));
      });

      function remove() {
        if (prompt("Î“ÏÎ¬ÏˆÎµ DELETE Î³Î¹Î± Î½Î± Î´Î¹Î±Î³ÏÎ¬ÏˆÎµÎ¹Ï‚ Ï„Î·Î½ Î»Î¯ÏƒÏ„Î±") === "DELETE") {
          localStorage.clear();
          $("#range").val("1..5000");
          print((localStorage.list = []));
        }
      }

      function shuffle() {
        if (
          !$("table tbody tr").length ||
          prompt("Î“ÏÎ¬ÏˆÎµ RANDOM Î³Î¹Î± Î½Î± Î±Î½Î±ÎºÎ±Ï„Î­ÏˆÎµÎ¹Ï‚ Ï„Î¿Ï…Ï‚ Î»Î±Ï‡Î½Î¿ÏÏ‚") === "RANDOM"
        ) {
          localStorage.clear();

          let valids = parse((localStorage.valids = $("#range").val()));

          const maxlen = `${valids.at(-1)}`.length;
          const tickets = valids.shuffle().map((ticket) => ticket.pad(maxlen));
          const items = list.map(
            (item, index) => (
              (item.id = -~index), (item.ticket = tickets.at(index)), item
            )
          );

          print(items);
        }
      }

      function print(items) {
        $("table tbody tr").remove();
        localStorage.valids && $("#range").val(localStorage.valids);
        for (const { id, gift, donor, ticket } of items) {
          const row = `<tr>
                           <td>${id}</td>
                           <td>${gift}</td>
                           <td>${donor}</td>
                           <td>
                               <button id="btn-id${id}" type="button" class="btn btn-secondary"
                                onclick="$(this).html('<strong>${ticket}</strong>')
                                  .removeClass('btn-secondary')
                                  .addClass('btn-success');
                                  localStorage.setItem('id${id}', true);">
                                  ğŸ²ğŸ²
                               </button>
                           </td>                       
                       </tr>`;

          $("table tbody").append(row);
          localStorage[`id${id}`] && $(`#btn-id${id}`).click();
        }
        localStorage.setItem("list", JSON.stringify(items));
      }

      function parse(string) {
        let res = [];
        let m;

        for (let str of string.split(",").map((str) => str.trim())) {
          // just a number
          if (/^-?\d+$/.test(str)) {
            res.push(parseInt(str, 10));
          } else if (
            (m = str.match(/^(-?\d+)(-|\.\.\.?|\u2025|\u2026|\u22EF)(-?\d+)$/))
          ) {
            // 1-5 or 1..5 (equivalent) or 1...5 (doesn't include 5)
            let [_, lhs, sep, rhs] = m;

            if (lhs && rhs) {
              lhs = parseInt(lhs);
              rhs = parseInt(rhs);
              const incr = lhs < rhs ? 1 : -1;

              // Make it inclusive by moving the right 'stop-point' away by one.
              if (sep === "-" || sep === ".." || sep === "\u2025") rhs += incr;

              for (let i = lhs; i !== rhs; i += incr) res.push(i);
            }
          }
        }

        return res;
      }
    </script>

    <div class="container col-xl-10 col-xxl-8 px-4 py-5">
      <div class="row align-items-center g-lg-5 py-5 mx-auto">
        <div class="col-lg-4 text-center text-lg-start">
          <img src="logo2.png" width="300px" />
        </div>
        <div class="col-lg-8 text-center text-lg-start">
          <h2 class="fw-bold lh-1 text-body-emphasis mb-3 text-center">
            Î•ÎšÎ ÎŸÎ›Î™Î¤Î™Î£Î¤Î™ÎšÎŸÎ£ Î•Î Î™ÎœÎŸÎ¡Î¦Î©Î¤Î™ÎšÎŸÎ£ Î•ÎÎ©Î¡Î‘ÎªÎ£Î¤Î™ÎšÎŸÎ£ Î£Î¥Î›Î›ÎŸÎ“ÎŸÎ£ Î¤Î©Î Î‘Î Î‘ÎÎ¤Î‘Î§ÎŸÎ¥
            Î˜Î‘Î¡Î¡ÎŸÎ¥ÎÎ™Î‘Î¤Î©Î
          </h2>
          <h3 class="display-1 text-center fw-bold">
            <span class="badge bg-dark">â€¹â€¹ Î— Î Î¡ÎŸÎŸÎ”ÎŸÎ£ â€ºâ€º</span>
          </h3>
        </div>
      </div>
      <hr />
      <div class="row align-items-center g-lg-5 py-5">
        <div class="col-md-10 mx-auto">
          <div class="shadow-lg p-5 mb-3 bg-body-tertiary rounded">
          <h1 class="display-1 text-center fw-bold glow">
            Î§ÎŸÎ¡ÎŸÎ•Î£Î Î•Î¡Î™Î”Î‘ Î˜Î‘Î¡Î¡ÎŸÎ¥ÎÎ™Î‘
          </h1>
          <h3 class="display-3 text-center fw-bold glow">
            <span id="date" class="badge bg-success rounded-pill"></span>
          </h3>
          <br />
          
            <p class="fs-5 text-center text-body-secondary">
              <strong>
                Î— ÎºÎ»Î®ÏÏ‰ÏƒÎ· Î»Î±Ï‡Î½ÏÎ½ Î´Î¹ÎµÎ¾Î¬Î³ÎµÏ„Î±Î¹ Î¼Îµ Î¼Î¹Î± Ï…Ï€ÎµÏÏƒÏÎ³Ï‡ÏÎ¿Î½Î· Î·Î»ÎµÎºÏ„ÏÎ¿Î½Î¹ÎºÎ®
                Î¼Î¿ÏÏ†Î®, Î· Î¿Ï€Î¿Î¯Î± ÏŒÏ‡Î¹ Î¼ÏŒÎ½Î¿ ÎµÎ¾Î±ÏƒÏ†Î±Î»Î¯Î¶ÎµÎ¹ Î±Ï€ÏŒÎ»Ï…Ï„Î· Î´Î¹Î±Ï†Î¬Î½ÎµÎ¹Î±, Î±Î»Î»Î¬ ÎºÎ±Î¹
                Î´Î¹Î±ÏƒÏ†Î±Î»Î¯Î¶ÎµÎ¹ Ï„Î·Î½ Î±ÎºÎµÏÎ±Î¹ÏŒÏ„Î·Ï„Î± Ï„Î·Ï‚ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î±Ï‚ ÏƒÎµ ÎºÎ¬Î¸Îµ ÏƒÏ„Î¬Î´Î¹Î¿. Î‘Ï…Ï„Î®
                Î· Î¼Î­Î¸Î¿Î´Î¿Ï‚ ÎµÎ³Î³Ï…Î¬Ï„Î±Î¹ Î­Î½Î± Î´Î¯ÎºÎ±Î¹Î¿ ÎºÎ±Î¹ Î±Î¼ÎµÏÏŒÎ»Î·Ï€Ï„Î¿ Î±Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î±,
                Î´Î¹Î±ÏƒÏ†Î±Î»Î¯Î¶Î¿Î½Ï„Î±Ï‚ ÏŒÏ„Î¹ ÎºÎ¬Î¸Îµ ÏƒÏ…Î¼Î¼ÎµÏ„Î­Ï‡Ï‰Î½ Î­Ï‡ÎµÎ¹ Î¯ÏƒÎµÏ‚ Ï€Î¹Î¸Î±Î½ÏŒÏ„Î·Ï„ÎµÏ‚ ÎºÎ±Î¹ ÏŒÏ„Î¹
                Ï„Î¿ Ï„ÎµÎ»Î¹ÎºÏŒ Î±Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î± ÎµÎ¯Î½Î±Î¹ Î±Î´Î¹Î¬Î²Î»Î·Ï„Î¿ ÎºÎ±Î¹ Î±Î¾Î¹ÏŒÏ€Î¹ÏƒÏ„Î¿.
              </strong>
            </p>
          </div>
        </div>
      </div>
      <hr />
      <div class="row align-items-center g-lg-5 py-5">
        <div class="col-md-10 mx-auto col-lg-8">
          <form class="p-4 p-md-5 border rounded-3 bg-body-tertiary">
            <div class="form-floating mb-3">
              <input
                type="text"
                class="form-control"
                id="range"
                placeholder="Î‘ÏÎ¹Î¸Î¼Î¿Î¯ Î»Î±Ï‡Î½ÏÎ½ Ï€Î¿Ï… ÏƒÏ…Î¼Î¼ÎµÏ„Î­Ï‡Î¿Ï…Î½ ÏƒÏ„Î·Î½ ÎºÎ»Î®ÏÏ‰ÏƒÎ·"
                value="1..5000"
              />
              <label for="range"
                >Î‘ÏÎ¹Î¸Î¼Î¿Î¯ Î»Î±Ï‡Î½ÏÎ½ Ï€Î¿Ï… ÏƒÏ…Î¼Î¼ÎµÏ„Î­Ï‡Î¿Ï…Î½ ÏƒÏ„Î·Î½ ÎºÎ»Î®ÏÏ‰ÏƒÎ·</label
              >
            </div>

            <div class="row">
              <div class="col-md-6">
                <div class="d-grid gap-2 col-12">
                  <button
                    type="button"
                    class="btn btn-lg btn-primary"
                    onclick="shuffle();"
                  >
                    <strong>ğŸ”€ Î‘Î½Î±ÎºÎ¬Ï„ÎµÏˆÎµ</strong>
                  </button>
                </div>
              </div>
              <div class="col-md-6">
                <div class="d-grid gap-2 col-12">
                  <button
                    type="button"
                    class="btn btn-lg btn-danger"
                    onclick="remove();"
                  >
                    <strong>âŒ Î”Î¹Î±Î³ÏÎ±Ï†Î®</strong>
                  </button>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>
      <hr />
      <div class="row align-items-center g-lg-5 py-5">
        <div class="col-lg-12 text-center text-lg-start">
          <table class="table table-dark table-striped">
            <thead>
              <tr>
                <th scope="col">#</th>
                <th scope="col">Î”ÏÏÎ¿</th>
                <th scope="col">Î§Î¿ÏÎ·Î³ÏŒÏ‚</th>
                <th scope="col">Î›Î±Ï‡Î½ÏŒÏ‚ #</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
      <div class="row">
        <p id="sign" class="text-lowercase text-body-secondary"></p>
      </div>
    </div>
  </body>
</html>
